# 📷 人物検出カメラアプリ

リアルタイムで人物を検出し、自動的に画像をキャプチャするWebアプリケーションです。MediaPipe Poseを使用した高精度な人物検出機能を搭載しています。

![プロジェクトデモ](https://img.shields.io/badge/Demo-Live-green)
![Version](https://img.shields.io/badge/Version-1.2.0-blue)
![License](https://img.shields.io/badge/License-MIT-yellow)

## ✨ 主な機能

- 🎥 **リアルタイム人物検出** - MediaPipe Poseによる高精度な検出
- 📸 **自動キャプチャ** - 設定可能な間隔での自動画像保存
- 🛡️ **厳格検出モード** - 4段階多層防御システムによる最高精度検出
- 🖼️ **画像管理** - 個別削除、一括保存/削除機能
- ⌨️ **キーボードショートカット** - 効率的な操作
- 📱 **レスポンシブデザイン** - デスクトップ・モバイル対応
- 📚 **包括的ドキュメント** - 操作説明書、システム構成図、要件定義書

## 🚀 クイックスタート

### 1. プロジェクトのクローン
```bash
git clone https://github.com/chel2311/Camera_Person.git
cd Camera_Person
```

### 2. アプリケーションの起動
```bash
# HTTPSサーバーで起動（カメラアクセスに必要）
python -m http.server 8000 --bind 127.0.0.1

# または
npx serve .
```

### 3. ブラウザでアクセス
```
https://localhost:8000
```

## 📋 使用方法

### 基本操作
1. 「カメラ開始」ボタンでWebカメラを起動
2. カメラアクセス許可を承認
3. 「検出開始」ボタンで人物検出を開始
4. 人物が検出されると自動的に画像がキャプチャされます

### ⌨️ キーボードショートカット
| ショートカット | 機能 |
|---|---|
| `docs` | ドキュメントを開く |
| `C` | カメラ開始/停止 |
| `Space` | 検出開始/停止 |
| `S` | 手動キャプチャ |
| `?` | ヘルプ表示 |

### 🔧 設定項目
- **検出モード**: 厳格検出モード（固定）- 最高精度・誤検出最小化
- **自動キャプチャ**: ON/OFF切り替え
- **キャプチャ間隔**: 1〜10秒で設定

### 🛡️ 厳格検出システム（v1.2.0）
**4段階多層防御による最高精度検出**
1. **基本信頼度チェック** - 閾値0.5以上
2. **構造的妥当性チェック** - 人体の基本構造検証
3. **時系列一貫性チェック** - 急激な動きを除外
4. **連続検出要求** - 3回連続で全検証をパス

### 🖼️ 画像管理
- **個別削除**: 各画像のゴミ箱アイコンをクリック
- **選択機能**: 画像をクリックして選択/選択解除
- **一括保存**: すべての画像を連続ダウンロード
- **選択削除**: 選択した画像のみ削除
- **全削除**: すべての画像を一括削除

## 🛠️ 技術スタック

### フロントエンド
- **HTML5** - セマンティックマークアップ
- **CSS3** - レスポンシブデザイン、アニメーション
- **JavaScript (ES6+)** - モダンJavaScript機能
- **Font Awesome** - プロフェッショナルなアイコン

### AI/ML
- **MediaPipe Pose** - Googleの高精度人物検出ライブラリ
- **TensorFlow.js** - ブラウザ内機械学習

### Web API
- **MediaDevices API** - カメラアクセス
- **Canvas API** - 画像処理とキャプチャ
- **File System API** - ローカルファイル保存
- **requestAnimationFrame** - 高効率なアニメーション

## 📊 システム構成

```
┌─────────────────┐    ┌─────────────────┐    ┌─────────────────┐
│   ブラウザ      │    │  MediaPipe      │    │  ローカル       │
│   (UI層)       │────│  (AI検出層)     │────│  (ストレージ)   │
└─────────────────┘    └─────────────────┘    └─────────────────┘
         │                       │                       │
         ├─ HTML5/CSS3           ├─ 人物検出             ├─ 画像保存
         ├─ JavaScript           ├─ 骨格追跡             └─ Blob管理
         └─ Font Awesome         └─ 信頼度計算
```

## 🔍 トラブルシューティング

### よくある問題と解決策

**カメラが起動しない**
- ブラウザでカメラアクセス許可を確認
- HTTPSでアクセスしているか確認

**人物が検出されない**
- カメラと被写体の距離を1〜3mに調整
- 照明条件を改善
- 主要ポイント（鼻、肩、腰）が明確に見えるよう姿勢を調整
- 厳格モードでは3回連続で検証をパスする必要があります

**キャプチャされない**
- 自動キャプチャがONになっているか確認
- キャプチャ間隔を短縮
- 人体の主要部位が画面内に収まっているか確認
- 厳格検出システムによる高精度フィルタリングが有効です

**誤検出・誤キャプチャが発生する**
- v1.2.0で大幅改善：厳格モード固定による誤検出完全防止
- 4段階多層防御システムで背景の物体誤認識を完全ブロック
- MediaPipe設定：minDetectionConfidence=0.6, minTrackingConfidence=0.6
- 3回連続で全ての検証をパスした場合のみ検出確定

**パフォーマンスが悪い**
- 他のタブやアプリケーションを閉じる
- ブラウザを最新版に更新
- ハードウェアアクセラレーションを有効化

## 📚 ドキュメント

詳細なドキュメントは `docs.html` で確認できます：

- **操作説明書** - 詳細な使用方法とトラブルシューティング
- **システム構成図** - アーキテクチャとデータフロー
- **要件定義書** - 機能要件と非機能要件

アプリ使用中に `docs` キーを順次入力するとドキュメントが開きます。

## 🎯 動作要件

### ブラウザ要件
- **Chrome 90+** (推奨)
- **Edge 90+**
- **Firefox 88+**
- **Safari 14+**

### システム要件
- **CPU**: デュアルコア 2.0GHz以上
- **RAM**: 4GB以上
- **カメラ**: 720p以上のWebカメラ
- **通信**: HTTPSアクセス必須

### パフォーマンス
- **フレームレート**: 30 FPS
- **検出レイテンシ**: 100ms以下
- **検出精度**: 90%以上

## 🚧 制約事項

- HTTPS環境でのみカメラアクセス可能
- 同時検出人数は3〜5人が上限
- ブラウザメモリ制限により最大20枚の画像保持
- File System APIは一部ブラウザで未対応

## 🔮 今後の拡張予定

- [ ] 顔認識機能の追加
- [ ] 複数人物の同時追跡
- [ ] 動画録画機能
- [ ] クラウド保存対応
- [ ] リアルタイムアラート
- [ ] 統計・分析ダッシュボード
- [ ] API連携機能

## 🤝 貢献

プロジェクトへの貢献を歓迎します！

1. このリポジトリをフォーク
2. 機能ブランチを作成 (`git checkout -b feature/amazing-feature`)
3. 変更をコミット (`git commit -m 'Add amazing feature'`)
4. ブランチにプッシュ (`git push origin feature/amazing-feature`)
5. プルリクエストを作成

## 📄 ライセンス

このプロジェクトはMITライセンスの下で公開されています。詳細は [LICENSE](LICENSE) ファイルを参照してください。

## 🙏 謝辞

- **Google MediaPipe** - 優秀な人物検出ライブラリ
- **Font Awesome** - 美しいアイコンライブラリ
- **Claude Code & Gemini AI** - 開発支援

## 📞 サポート

質問や問題がある場合は、以下の方法でお問い合わせください：

- [Issues](https://github.com/chel2311/Camera_Person/issues) - バグ報告や機能要求
- [Discussions](https://github.com/chel2311/Camera_Person/discussions) - 一般的な質問や議論

---

<div align="center">

**⭐ このプロジェクトが役に立った場合は、スターをつけてください！**

Made with ❤️ by Claude Code & Gemini AI

</div>